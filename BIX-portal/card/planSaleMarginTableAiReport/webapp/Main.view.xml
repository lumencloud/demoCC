<mvc:View
    xmlns:core="sap.ui.core"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns="sap.m"
    xmlns:table="sap.ui.table"
    xmlns:rowmodes="sap.ui.table.rowmodes"
    width="100%"
    height="100%"
    displayBlock="true"
    controllerName="bix.card.planSaleMarginTableAiReport.Main"
>
    <Panel
        expandable="false"
        expanded="true"
        width="auto"
        height="100%"
        class="sapUiNoContentPadding"
    >
        
        <content>
            <VBox width="100%" height="100%">        
                <VBox busyIndicatorDelay="0" visible="{=${uiModel>/subKey} === 'org'}" class="custom-vbox-wrap-table" height="100%">
                    <table:Table
                        id="planSaleMarginTable1"
                        rows="{path:'/'}"
                        class=" custom-table-container custom-table-header custom-table-body custom-pl-detail-table custom-uiTable-selection custom-inherit-height"
                        selectionMode="Single" 
                        selectionBehavior="RowOnly" 
                        firstVisibleRowChanged="onFirstVisibleRowChanged"
                        rowSelectionChange=".onRowSelectionChange"
                        fixedColumnCount="1"
                        busyIndicatorDelay="0"
                        visibleRowCountMode="Auto"
                        noData=" "
                        fieldGroupIds="content,org"
                    >
                        <table:extension>
                            <OverflowToolbar width="100%" height="3rem" style="Standard" class="custom-aireport-header">

                                <Image src="./resource/icon/aipopup/aipopup_icon01.png" width="24px" height="24px"/>
                                <Text text="세부 데이터" class="table-title"/>
                                <ToolbarSpacer />
                                <Button text="엑셀 다운로드" class="custom-text-semibold" icon="sap-icon://excel-attachment" type="Neutral" press="onExcelDownload" visible="false" />
                                <ToolbarSeparator visible="false" />
                                <Text emptyIndicatorMode="On"  text="단위 (억)" visible="false"/>
                            </OverflowToolbar>
                        </table:extension>

                        <table:layoutData>
                            <FlexItemData growFactor="1"/>
                        </table:layoutData>
                    
                        <table:columns>
                            <table:Column
                                hAlign="Center"
                                width="10rem"
                                resizable="false"
                                name="type"
                            >
                                <Label
                                    text="조직"
                                    wrapping="true"
                                />
                                <table:template>
                                    <Text emptyIndicatorMode="On"
                                        text="{org_name}"
                                        wrapping="false"
                                        width="100%"
                                        textAlign="Begin"
                                    />
                                </table:template>
                                <table:customData>
                                    <core:CustomData key="mergeKey" value="org_name" />
                                </table:customData>
                            </table:Column>

                            <table:Column
                                hAlign="Center"
                                headerSpan="6"
                                resizable="false"
                                width="7rem"
                            >
                                <table:multiLabels>
                                    <Label
                                        text="연간 추정"
                                        wrapping="true"
                                    />
                                    <Label
                                        text="합계"
                                        textAlign="Center"
                                        width="100%"
                                    />
                                </table:multiLabels>
                                <table:template>
                                    <Text emptyIndicatorMode="On"
                                        text="{
                                            parts:[
                                                {path:'forecast_value', targetType: 'any'},
                                                {path:'type', targetType: 'any'}
                                            ],
                                            formatter: '.onFormatPerformance'
                                        }"
                                        tooltip="{
                                            parts:[
                                                {path:'forecast_value', targetType: 'any'},
                                                {path:'type', targetType: 'any'},
                                                {value:'tooltip'}
                                            ],
                                            formatter: '.onFormatPerformance'                                
                                        }"
                                        wrapping="false"
                                        width="100%"
                                        textAlign="End"
                                    />
                                </table:template>
                            </table:Column>

                            <!-- <table:Column
                                hAlign="Center"
                                width="7rem"
                                resizable="false"
                            >
                                <table:multiLabels>
                                    <Label
                                        text="연간 추정"
                                        wrapping="true"
                                    />
                                    <Label
                                        text="확보"
                                        textAlign="Center"
                                        width="100%"
                                    />
                                </table:multiLabels>
                                <table:template>
                                    <Text emptyIndicatorMode="On"
                                        text="{
                                            parts:[
                                                {path:'secured_value', targetType: 'any'}
                                            ],
                                            formatter: '.onFormatPerformance'
                                        }"
                                        tooltip="{
                                            parts:[
                                                {path:'secured_value', targetType: 'any'},
                                                {value:'tooltip'}
                                            ],
                                            formatter: '.onFormatPerformance'                                
                                        }"
                                        wrapping="false"
                                        width="100%"
                                        textAlign="End"
                                    />
                                </table:template>
                            </table:Column> -->

                            <table:Column
                                hAlign="Center"
                                width="7rem"
                                resizable="false"
                            >
                                <table:multiLabels>
                                    <Label
                                        text="연간 추정"
                                        wrapping="true"
                                    />
                                    <Label
                                        text="실적"
                                        textAlign="Center"
                                        width="100%"
                                    />
                                </table:multiLabels>
                                <table:template>
                                    <Text emptyIndicatorMode="On"
                                        text="{
                                            parts:[
                                                {path:'secured_actual_value', targetType: 'any'},
                                                {path:'type', targetType: 'any'}
                                            ],
                                            formatter: '.onFormatPerformance'
                                        }"
                                        tooltip="{
                                            parts:[
                                                {path:'secured_actual_value', targetType: 'any'},
                                                {path:'type', targetType: 'any'},
                                                {value:'tooltip'}
                                            ],
                                            formatter: '.onFormatPerformance'                                
                                        }"
                                        wrapping="false"
                                        width="100%"
                                        textAlign="End"
                                    />
                                </table:template>
                            </table:Column>

                            <table:Column
                                hAlign="Center"
                                width="7rem"
                                resizable="false"
                            >
                                <table:multiLabels>
                                    <Label
                                        text="연간 추정"
                                        wrapping="true"
                                    />
                                    <Label
                                        text="확보 추정"
                                        textAlign="Center"
                                        width="100%"
                                    />
                                </table:multiLabels>
                                <table:template>
                                    <Text emptyIndicatorMode="On"
                                        text="{
                                            parts:[
                                                {path:'secured_forecast_value', targetType: 'any'}
                                            ],
                                            formatter: '.onFormatPerformance'
                                        }"
                                        tooltip="{
                                            parts:[
                                                {path:'secured_forecast_value', targetType: 'any'},
                                                {path:'type', targetType: 'any'},
                                                {value:'tooltip'}
                                            ],
                                            formatter: '.onFormatPerformance'                                
                                        }"
                                        wrapping="false"
                                        width="100%"
                                        textAlign="End"
                                    />
                                </table:template>
                            </table:Column>

                            <table:Column
                                hAlign="Center"
                                width="7rem"
                                resizable="false"
                            >
                                <table:multiLabels>
                                    <Label
                                        text="연간 추정"
                                        wrapping="true"
                                    />
                                    <Label
                                        text="미확보"
                                        textAlign="Center"
                                        width="100%"
                                    />
                                </table:multiLabels>
                                <table:template>
                                    <Text emptyIndicatorMode="On"
                                        text="{
                                            parts:[
                                                {path:'not_secured_value', targetType: 'any'},
                                                {path:'type', targetType: 'any'}
                                            ],
                                            formatter: '.onFormatPerformance'
                                        }"
                                        tooltip="{
                                            parts:[
                                                {path:'not_secured_value', targetType: 'any'},
                                                {path:'type', targetType: 'any'},
                                                {value:'tooltip'}
                                            ],
                                            formatter: '.onFormatPerformance'                                
                                        }"
                                        wrapping="false"
                                        width="100%"
                                        textAlign="End"
                                    />
                                </table:template>
                            </table:Column>

                            <table:Column
                                hAlign="Center"
                                width="7rem"
                                resizable="false"
                            >
                                <table:multiLabels>
                                    <Label
                                        text="연간 추정"
                                        wrapping="true"
                                    />
                                    <Label
                                        text="계획비"
                                        textAlign="Center"
                                        width="100%"
                                    />
                                </table:multiLabels>
                                <table:template>
                                    <Text emptyIndicatorMode="On"
                                        text="{
                                            parts:[
                                                {path:'plan_ratio', targetType: 'any'},
                                                {path:'type', targetType: 'any'}
                                            ],
                                            formatter: '.onFormatPerformance'
                                        }"
                                        tooltip="{
                                            parts:[
                                                {path:'plan_ratio', targetType: 'any'},
                                                {path:'type', targetType: 'any'},
                                                {value:'tooltip'}
                                            ],
                                            formatter: '.onFormatPerformance'                                
                                        }"
                                        wrapping="false"
                                        width="100%"
                                        textAlign="End"
                                    />
                                </table:template>
                            </table:Column>

                            <table:Column
                                hAlign="Center"
                                width="7rem"
                                resizable="false"
                            >
                                <table:multiLabels>
                                    <Label
                                        text="연간 추정"
                                        wrapping="true"
                                    />
                                    <Label
                                        text="전년비"
                                        textAlign="Center"
                                        width="100%"
                                    />
                                </table:multiLabels>
                                <table:template>
                                    <Text emptyIndicatorMode="On"
                                        text="{
                                            parts:[
                                                {path:'yoy', targetType: 'any'},
                                                {path:'type', targetType: 'any'}
                                            ],
                                            formatter: '.onFormatPerformance'
                                        }"
                                        tooltip="{
                                            parts:[
                                                {path:'yoy', targetType: 'any'},
                                                {path:'type', targetType: 'any'},
                                                {value:'tooltip'}
                                            ],
                                            formatter: '.onFormatPerformance'                                
                                        }"
                                        wrapping="false"
                                        width="100%"
                                        textAlign="End"
                                    />
                                </table:template>
                            </table:Column>
                        </table:columns>
                    </table:Table>
                </VBox>

                <VBox busyIndicatorDelay="0" visible="{=${uiModel>/subKey} === 'org_delivery'}" class="custom-vbox-wrap-table" height="100%">
                    <table:Table
                        id="planSaleMarginTable2"
                        rows="{path:'/'}"
                        class=" custom-table-container custom-table-header custom-table-body custom-pl-detail-table custom-uiTable-selection custom-inherit-height"
                        selectionMode="Single" 
                        selectionBehavior="RowOnly" 
                        firstVisibleRowChanged="onFirstVisibleRowChanged"
                        rowSelectionChange=".onRowSelectionChange"
                        fixedColumnCount="1"
                        busyIndicatorDelay="0"
                        visibleRowCountMode="Auto"
                        noData=" "
                        fieldGroupIds="content,org_delivery"
                    >
                        <table:extension>
                            <OverflowToolbar width="100%" height="3rem" style="Standard" class="custom-aireport-header">

                                <Image src="./resource/icon/aipopup/aipopup_icon01.png" width="24px" height="24px"/>
                                <Text text="세부 데이터" class="table-title"/>
                                <ToolbarSpacer />
                                <Button text="엑셀 다운로드" class="custom-text-semibold" icon="sap-icon://excel-attachment" type="Neutral" press="onExcelDownload" visible="false" />
                                <ToolbarSeparator visible="false" />
                                <Text emptyIndicatorMode="On"  text="단위 (억)" visible="false"/>
                            </OverflowToolbar>
                        </table:extension>

                        <table:layoutData>
                            <FlexItemData growFactor="1"/>
                        </table:layoutData>
                    
                        <table:columns>
                            <table:Column
                                hAlign="Center"
                                width="10rem"
                                resizable="false"
                                name="type"
                            >
                                <Label
                                    text="조직"
                                    wrapping="true"
                                />
                                <table:template>
                                    <Text emptyIndicatorMode="On"
                                        text="{org_name}"
                                        wrapping="false"
                                        width="100%"
                                        textAlign="Begin"
                                    />
                                </table:template>
                                <table:customData>
                                    <core:CustomData key="mergeKey" value="org_name" />
                                </table:customData>
                            </table:Column>

                            <table:Column
                                hAlign="Center"
                                headerSpan="6"
                                resizable="false"
                                width="7rem"
                            >
                                <table:multiLabels>
                                    <Label
                                        text="연간 추정"
                                        wrapping="true"
                                    />
                                    <Label
                                        text="합계"
                                        textAlign="Center"
                                        width="100%"
                                    />
                                </table:multiLabels>
                                <table:template>
                                    <Text emptyIndicatorMode="On"
                                        text="{
                                            parts:[
                                                {path:'forecast_value', targetType: 'any'},
                                                {path:'type', targetType: 'any'}
                                            ],
                                            formatter: '.onFormatPerformance'
                                        }"
                                        tooltip="{
                                            parts:[
                                                {path:'forecast_value', targetType: 'any'},
                                                {path:'type', targetType: 'any'},
                                                {value:'tooltip'}
                                            ],
                                            formatter: '.onFormatPerformance'                                
                                        }"
                                        wrapping="false"
                                        width="100%"
                                        textAlign="End"
                                    />
                                </table:template>
                            </table:Column>

                            <!-- <table:Column
                                hAlign="Center"
                                width="7rem"
                                resizable="false"
                            >
                                <table:multiLabels>
                                    <Label
                                        text="연간 추정"
                                        wrapping="true"
                                    />
                                    <Label
                                        text="확보"
                                        textAlign="Center"
                                        width="100%"
                                    />
                                </table:multiLabels>
                                <table:template>
                                    <Text emptyIndicatorMode="On"
                                        text="{
                                            parts:[
                                                {path:'secured_value', targetType: 'any'}
                                            ],
                                            formatter: '.onFormatPerformance'
                                        }"
                                        tooltip="{
                                            parts:[
                                                {path:'secured_value', targetType: 'any'},
                                                {value:'tooltip'}
                                            ],
                                            formatter: '.onFormatPerformance'                                
                                        }"
                                        wrapping="false"
                                        width="100%"
                                        textAlign="End"
                                    />
                                </table:template>
                            </table:Column> -->

                            <table:Column
                                hAlign="Center"
                                width="7rem"
                                resizable="false"
                            >
                                <table:multiLabels>
                                    <Label
                                        text="연간 추정"
                                        wrapping="true"
                                    />
                                    <Label
                                        text="실적"
                                        textAlign="Center"
                                        width="100%"
                                    />
                                </table:multiLabels>
                                <table:template>
                                    <Text emptyIndicatorMode="On"
                                        text="{
                                            parts:[
                                                {path:'secured_actual_value', targetType: 'any'},
                                                {path:'type', targetType: 'any'}
                                            ],
                                            formatter: '.onFormatPerformance'
                                        }"
                                        tooltip="{
                                            parts:[
                                                {path:'secured_actual_value', targetType: 'any'},
                                                {path:'type', targetType: 'any'},
                                                {value:'tooltip'}
                                            ],
                                            formatter: '.onFormatPerformance'                                
                                        }"
                                        wrapping="false"
                                        width="100%"
                                        textAlign="End"
                                    />
                                </table:template>
                            </table:Column>

                            <table:Column
                                hAlign="Center"
                                width="7rem"
                                resizable="false"
                            >
                                <table:multiLabels>
                                    <Label
                                        text="연간 추정"
                                        wrapping="true"
                                    />
                                    <Label
                                        text="확보 추정"
                                        textAlign="Center"
                                        width="100%"
                                    />
                                </table:multiLabels>
                                <table:template>
                                    <Text emptyIndicatorMode="On"
                                        text="{
                                            parts:[
                                                {path:'secured_forecast_value', targetType: 'any'},
                                                {path:'type', targetType: 'any'}
                                            ],
                                            formatter: '.onFormatPerformance'
                                        }"
                                        tooltip="{
                                            parts:[
                                                {path:'secured_forecast_value', targetType: 'any'},
                                                {path:'type', targetType: 'any'},
                                                {value:'tooltip'}
                                            ],
                                            formatter: '.onFormatPerformance'                                
                                        }"
                                        wrapping="false"
                                        width="100%"
                                        textAlign="End"
                                    />
                                </table:template>
                            </table:Column>

                            <table:Column
                                hAlign="Center"
                                width="7rem"
                                resizable="false"
                            >
                                <table:multiLabels>
                                    <Label
                                        text="연간 추정"
                                        wrapping="true"
                                    />
                                    <Label
                                        text="미확보"
                                        textAlign="Center"
                                        width="100%"
                                    />
                                </table:multiLabels>
                                <table:template>
                                    <Text emptyIndicatorMode="On"
                                        text="{
                                            parts:[
                                                {path:'not_secured_value', targetType: 'any'},
                                                {path:'type', targetType: 'any'}
                                            ],
                                            formatter: '.onFormatPerformance'
                                        }"
                                        tooltip="{
                                            parts:[
                                                {path:'not_secured_value', targetType: 'any'},
                                                {path:'type', targetType: 'any'},
                                                {value:'tooltip'}
                                            ],
                                            formatter: '.onFormatPerformance'                                
                                        }"
                                        wrapping="false"
                                        width="100%"
                                        textAlign="End"
                                    />
                                </table:template>
                            </table:Column>

                            <table:Column
                                hAlign="Center"
                                width="7rem"
                                resizable="false"
                            >
                                <table:multiLabels>
                                    <Label
                                        text="연간 추정"
                                        wrapping="true"
                                    />
                                    <Label
                                        text="계획비"
                                        textAlign="Center"
                                        width="100%"
                                    />
                                </table:multiLabels>
                                <table:template>
                                    <Text emptyIndicatorMode="On"
                                        text="{
                                            parts:[
                                                {path:'plan_ratio', targetType: 'any'},
                                                {path:'type', targetType: 'any'}
                                            ],
                                            formatter: '.onFormatPerformance'
                                        }"
                                        tooltip="{
                                            parts:[
                                                {path:'plan_ratio', targetType: 'any'},
                                                {path:'type', targetType: 'any'},
                                                {value:'tooltip'}
                                            ],
                                            formatter: '.onFormatPerformance'                                
                                        }"
                                        wrapping="false"
                                        width="100%"
                                        textAlign="End"
                                    />
                                </table:template>
                            </table:Column>

                            <table:Column
                                hAlign="Center"
                                width="7rem"
                                resizable="false"
                            >
                                <table:multiLabels>
                                    <Label
                                        text="연간 추정"
                                        wrapping="true"
                                    />
                                    <Label
                                        text="전년비"
                                        textAlign="Center"
                                        width="100%"
                                    />
                                </table:multiLabels>
                                <table:template>
                                    <Text emptyIndicatorMode="On"
                                        text="{
                                            parts:[
                                                {path:'yoy', targetType: 'any'},
                                                {path:'type', targetType: 'any'}
                                            ],
                                            formatter: '.onFormatPerformance'
                                        }"
                                        tooltip="{
                                            parts:[
                                                {path:'yoy', targetType: 'any'},
                                                {path:'type', targetType: 'any'},
                                                {value:'tooltip'}
                                            ],
                                            formatter: '.onFormatPerformance'                                
                                        }"
                                        wrapping="false"
                                        width="100%"
                                        textAlign="End"
                                    />
                                </table:template>
                            </table:Column>
                        </table:columns>
                    </table:Table>
                </VBox>

                <VBox busyIndicatorDelay="0" visible="{=${uiModel>/subKey} === 'org_account'}" class="custom-vbox-wrap-table" height="100%">
                    <table:Table
                        id="planSaleMarginTable3"
                        rows="{path:'/'}"
                        class=" custom-table-container custom-table-header custom-table-body custom-pl-detail-table custom-uiTable-selection custom-inherit-height"
                        selectionMode="Single" 
                        selectionBehavior="RowOnly" 
                        firstVisibleRowChanged="onFirstVisibleRowChanged"
                        rowSelectionChange=".onRowSelectionChange"
                        fixedColumnCount="1"
                        busyIndicatorDelay="0"
                        visibleRowCountMode="Auto"
                        noData=" "
                        fieldGroupIds="content,org_account"
                    >
                        <table:extension>
                            <OverflowToolbar width="100%" height="3rem" style="Standard" class="custom-aireport-header">

                                <Image src="./resource/icon/aipopup/aipopup_icon01.png" width="24px" height="24px"/>
                                <Text text="세부 데이터" class="table-title"/>
                                <ToolbarSpacer />
                                <Button text="엑셀 다운로드" class="custom-text-semibold" icon="sap-icon://excel-attachment" type="Neutral" press="onExcelDownload" visible="false" />
                                <ToolbarSeparator visible="false" />
                                <Text emptyIndicatorMode="On"  text="단위 (억)" visible="false"/>
                            </OverflowToolbar>
                        </table:extension>

                        <table:layoutData>
                            <FlexItemData growFactor="1"/>
                        </table:layoutData>
                    
                        <table:columns>
                            <table:Column
                                hAlign="Center"
                                width="10rem"
                                resizable="false"
                                name="type"
                            >
                                <Label
                                    text="조직"
                                    wrapping="true"
                                />
                                <table:template>
                                    <Text emptyIndicatorMode="On"
                                        text="{org_name}"
                                        wrapping="false"
                                        width="100%"
                                        textAlign="Begin"
                                    />
                                </table:template>
                                <table:customData>
                                    <core:CustomData key="mergeKey" value="org_name" />
                                </table:customData>
                            </table:Column>

                            <table:Column
                                hAlign="Center"
                                headerSpan="6"
                                resizable="false"
                                width="7rem"
                            >
                                <table:multiLabels>
                                    <Label
                                        text="연간 추정"
                                        wrapping="true"
                                    />
                                    <Label
                                        text="합계"
                                        textAlign="Center"
                                        width="100%"
                                    />
                                </table:multiLabels>
                                <table:template>
                                    <Text emptyIndicatorMode="On"
                                        text="{
                                            parts:[
                                                {path:'forecast_value', targetType: 'any'}
                                            ],
                                            formatter: '.onFormatPerformance'
                                        }"
                                        tooltip="{
                                            parts:[
                                                {path:'forecast_value', targetType: 'any'},
                                                {value:'tooltip'}
                                            ],
                                            formatter: '.onFormatPerformance'                                
                                        }"
                                        wrapping="false"
                                        width="100%"
                                        textAlign="End"
                                    />
                                </table:template>
                            </table:Column>

                            <!-- <table:Column
                                hAlign="Center"
                                width="7rem"
                                resizable="false"
                            >
                                <table:multiLabels>
                                    <Label
                                        text="연간 추정"
                                        wrapping="true"
                                    />
                                    <Label
                                        text="확보"
                                        textAlign="Center"
                                        width="100%"
                                    />
                                </table:multiLabels>
                                <table:template>
                                    <Text emptyIndicatorMode="On"
                                        text="{
                                            parts:[
                                                {path:'secured_value', targetType: 'any'}
                                            ],
                                            formatter: '.onFormatPerformance'
                                        }"
                                        tooltip="{
                                            parts:[
                                                {path:'secured_value', targetType: 'any'},
                                                {value:'tooltip'}
                                            ],
                                            formatter: '.onFormatPerformance'                                
                                        }"
                                        wrapping="false"
                                        width="100%"
                                        textAlign="End"
                                    />
                                </table:template>
                            </table:Column> -->

                            <table:Column
                                hAlign="Center"
                                width="7rem"
                                resizable="false"
                            >
                                <table:multiLabels>
                                    <Label
                                        text="연간 추정"
                                        wrapping="true"
                                    />
                                    <Label
                                        text="실적"
                                        textAlign="Center"
                                        width="100%"
                                    />
                                </table:multiLabels>
                                <table:template>
                                    <Text emptyIndicatorMode="On"
                                        text="{
                                            parts:[
                                                {path:'secured_actual_value', targetType: 'any'}
                                            ],
                                            formatter: '.onFormatPerformance'
                                        }"
                                        tooltip="{
                                            parts:[
                                                {path:'secured_actual_value', targetType: 'any'},
                                                {value:'tooltip'}
                                            ],
                                            formatter: '.onFormatPerformance'                                
                                        }"
                                        wrapping="false"
                                        width="100%"
                                        textAlign="End"
                                    />
                                </table:template>
                            </table:Column>

                            <table:Column
                                hAlign="Center"
                                width="7rem"
                                resizable="false"
                            >
                                <table:multiLabels>
                                    <Label
                                        text="연간 추정"
                                        wrapping="true"
                                    />
                                    <Label
                                        text="확보 추정"
                                        textAlign="Center"
                                        width="100%"
                                    />
                                </table:multiLabels>
                                <table:template>
                                    <Text emptyIndicatorMode="On"
                                        text="{
                                            parts:[
                                                {path:'secured_forecast_value', targetType: 'any'}
                                            ],
                                            formatter: '.onFormatPerformance'
                                        }"
                                        tooltip="{
                                            parts:[
                                                {path:'secured_forecast_value', targetType: 'any'},
                                                {value:'tooltip'}
                                            ],
                                            formatter: '.onFormatPerformance'                                
                                        }"
                                        wrapping="false"
                                        width="100%"
                                        textAlign="End"
                                    />
                                </table:template>
                            </table:Column>

                            <table:Column
                                hAlign="Center"
                                width="7rem"
                                resizable="false"
                            >
                                <table:multiLabels>
                                    <Label
                                        text="연간 추정"
                                        wrapping="true"
                                    />
                                    <Label
                                        text="미확보"
                                        textAlign="Center"
                                        width="100%"
                                    />
                                </table:multiLabels>
                                <table:template>
                                    <Text emptyIndicatorMode="On"
                                        text="{
                                            parts:[
                                                {path:'not_secured_value', targetType: 'any'}
                                            ],
                                            formatter: '.onFormatPerformance'
                                        }"
                                        tooltip="{
                                            parts:[
                                                {path:'not_secured_value', targetType: 'any'},
                                                {value:'tooltip'}
                                            ],
                                            formatter: '.onFormatPerformance'                                
                                        }"
                                        wrapping="false"
                                        width="100%"
                                        textAlign="End"
                                    />
                                </table:template>
                            </table:Column>

                            <table:Column
                                hAlign="Center"
                                width="7rem"
                                resizable="false"
                            >
                                <table:multiLabels>
                                    <Label
                                        text="연간 추정"
                                        wrapping="true"
                                    />
                                    <Label
                                        text="계획비"
                                        textAlign="Center"
                                        width="100%"
                                    />
                                </table:multiLabels>
                                <table:template>
                                    <Text emptyIndicatorMode="On"
                                        text="{
                                            parts:[
                                                {path:'plan_ratio', targetType: 'any'}
                                            ],
                                            formatter: '.onFormatPerformance'
                                        }"
                                        tooltip="{
                                            parts:[
                                                {path:'plan_ratio', targetType: 'any'},
                                                {value:'tooltip'}
                                            ],
                                            formatter: '.onFormatPerformance'                                
                                        }"
                                        wrapping="false"
                                        width="100%"
                                        textAlign="End"
                                    />
                                </table:template>
                            </table:Column>

                            <table:Column
                                hAlign="Center"
                                width="7rem"
                                resizable="false"
                            >
                                <table:multiLabels>
                                    <Label
                                        text="연간 추정"
                                        wrapping="true"
                                    />
                                    <Label
                                        text="전년비"
                                        textAlign="Center"
                                        width="100%"
                                    />
                                </table:multiLabels>
                                <table:template>
                                    <Text emptyIndicatorMode="On"
                                        text="{
                                            parts:[
                                                {path:'yoy', targetType: 'any'}
                                            ],
                                            formatter: '.onFormatPerformance'
                                        }"
                                        tooltip="{
                                            parts:[
                                                {path:'yoy', targetType: 'any'},
                                                {value:'tooltip'}
                                            ],
                                            formatter: '.onFormatPerformance'                                
                                        }"
                                        wrapping="false"
                                        width="100%"
                                        textAlign="End"
                                    />
                                </table:template>
                            </table:Column>
                        </table:columns>
                    </table:Table>
                </VBox>

                    <VBox fitContainer="true" busyIndicatorDelay="0" visible="{=${uiModel>/subKey} === 'account'}" class="custom-vbox-wrap-table"
                            height="100%">

                    <table:Table
                        id="planSaleMarginTable4"
                        rows="{path:'/'}"
                        class=" custom-table-container custom-table-header custom-table-body custom-pl-detail-table custom-uiTable-selection custom-inherit-height"
                        selectionMode="Single" 
                        selectionBehavior="RowOnly" 
                        firstVisibleRowChanged="onFirstVisibleRowChanged"
                        rowSelectionChange=".onRowSelectionChange"
                        fixedColumnCount="1"
                        busyIndicatorDelay="0"
                        visibleRowCountMode="Auto"
                        noData=" "
                        fieldGroupIds="content,account"
                    >
                        <table:extension>
                            <OverflowToolbar width="100%" height="3rem" style="Standard" class="custom-aireport-header">

                                <Image src="./resource/icon/aipopup/aipopup_icon01.png" width="24px" height="24px"/>
                                <Text text="세부 데이터" class="table-title"/>
                                <ToolbarSpacer />
                                <Button text="엑셀 다운로드" class="custom-text-semibold" icon="sap-icon://excel-attachment" type="Neutral" press="onExcelDownload" visible="false" />
                                <ToolbarSeparator visible="false" />
                                <Text emptyIndicatorMode="On"  text="단위 (억)" visible="false" />
                            </OverflowToolbar>
                        </table:extension>
                        <table:layoutData>
                            <FlexItemData growFactor="1"/>
                        </table:layoutData>
                        

                        <table:columns>
                            <table:Column
                                hAlign="Center"
                                width="10rem"
                                resizable="false"
                                name="type"
                            >
                                <Label
                                    text="고객사명"
                                    wrapping="true"
                                />
                                <table:template>
                                    <Text emptyIndicatorMode="On"
                                        text="{cstco_name}"
                                        wrapping="false"
                                        width="100%"
                                        textAlign="Begin"
                                    />
                                </table:template>
                                <table:customData>
                                    <core:CustomData key="mergeKey" value="cstco_name" />
                                </table:customData>
                            </table:Column>

                            <table:Column
                                hAlign="Center"
                                headerSpan="5"
                                resizable="false"
                                width="7rem"
                            >
                                <table:multiLabels>
                                    <Label
                                        text="연간 추정"
                                        wrapping="true"
                                    />
                                    <Label
                                        text="합계"
                                        textAlign="Center"
                                        width="100%"
                                    />
                                </table:multiLabels>
                                <table:template>
                                    <Text emptyIndicatorMode="On"
                                        text="{
                                            parts:[
                                                {path:'forecast', targetType: 'any'}
                                            ],
                                            formatter: '.onFormatPerformance'
                                        }"
                                        tooltip="{
                                            parts:[
                                                {path:'forecast', targetType: 'any'},
                                                {value:'tooltip'}
                                            ],
                                            formatter: '.onFormatPerformance'                                
                                        }"
                                        wrapping="false"
                                        width="100%"
                                        textAlign="End"
                                    />
                                </table:template>
                            </table:Column>
                            <table:Column
                                hAlign="Center"
                                width="7rem"
                                resizable="false"
                            >
                                <table:multiLabels>
                                    <Label
                                        text="연간 추정"
                                        wrapping="true"
                                    />
                                    <Label
                                        text="확보"
                                        textAlign="Center"
                                        width="100%"
                                    />
                                </table:multiLabels>
                                <table:template>
                                    <Text emptyIndicatorMode="On"
                                        text="{
                                            parts:[
                                                {path:'secured', targetType: 'any'}
                                            ],
                                            formatter: '.onFormatPerformance'
                                        }"
                                        tooltip="{
                                            parts:[
                                                {path:'secured', targetType: 'any'},
                                                {value:'tooltip'}
                                            ],
                                            formatter: '.onFormatPerformance'                                
                                        }"
                                        wrapping="false"
                                        width="100%"
                                        textAlign="End"
                                    />
                                </table:template>
                            </table:Column>

                            <table:Column
                                hAlign="Center"
                                width="7rem"
                                resizable="false"
                            >
                                <table:multiLabels>
                                    <Label
                                        text="연간 추정"
                                        wrapping="true"
                                    />
                                    <Label
                                        text="미확보"
                                        textAlign="Center"
                                        width="100%"
                                    />
                                </table:multiLabels>
                                <table:template>
                                    <Text emptyIndicatorMode="On"
                                        text="{
                                            parts:[
                                                {path:'not_secured', targetType: 'any'}
                                            ],
                                            formatter: '.onFormatPerformance'
                                        }"
                                        tooltip="{
                                            parts:[
                                                {path:'not_secured', targetType: 'any'},
                                                {value:'tooltip'}
                                            ],
                                            formatter: '.onFormatPerformance'                                
                                        }"
                                        wrapping="false"
                                        width="100%"
                                        textAlign="End"
                                    />
                                </table:template>
                            </table:Column>

                            <table:Column
                                hAlign="Center"
                                width="7rem"
                                resizable="false"
                            >
                                <table:multiLabels>
                                    <Label
                                        text="연간 추정"
                                        wrapping="true"
                                    />
                                    <Label
                                        text="계획비"
                                        textAlign="Center"
                                        width="100%"
                                    />
                                </table:multiLabels>
                                <table:template>
                                    <HBox width="100%" height="100%" class="cutsom-table-empty-cell">
                                        <Text text="" width="100%"  />
                                    </HBox>
                                </table:template>
                            </table:Column>

                            <table:Column
                                hAlign="Center"
                                width="7rem"
                                resizable="false"
                            >
                                <table:multiLabels>
                                    <Label
                                        text="연간 추정"
                                        wrapping="true"
                                    />
                                    <Label
                                        text="전년비"
                                        textAlign="Center"
                                        width="100%"
                                    />
                                </table:multiLabels>
                                <table:template>
                                    <HBox width="100%" height="100%" class="cutsom-table-empty-cell">
                                        <Text text="" width="100%"  />
                                    </HBox>
                                </table:template>
                            </table:Column>
                        </table:columns>
                    </table:Table>

                    </VBox>
                    <VBox fitContainer="true" busyIndicatorDelay="0" visible="{=${uiModel>/subKey} === 'relsco'}" class="custom-vbox-wrap-table"
                            height="100%">

                    <table:Table
                        id="planSaleMarginTable5"
                        rows="{path:'/'}"
                        class=" custom-table-container custom-table-header custom-table-body custom-pl-detail-table custom-uiTable-selection custom-inherit-height"
                        selectionMode="Single" 
                        selectionBehavior="RowOnly" 
                        firstVisibleRowChanged="onFirstVisibleRowChanged"
                        rowSelectionChange=".onRowSelectionChange"
                        fixedColumnCount="2"
                        busyIndicatorDelay="0"
                        visibleRowCountMode="Auto"
                        noData=" "
                        fieldGroupIds="content,relsco"
                    >
                        <table:extension>
                            <OverflowToolbar width="100%" height="3rem" style="Standard" class="custom-aireport-header">

                                <Image src="./resource/icon/aipopup/aipopup_icon01.png" width="24px" height="24px"/>
                                <Text text="세부 데이터" class="table-title"/>
                                <ToolbarSpacer />
                                <Button text="엑셀 다운로드" class="custom-text-semibold" icon="sap-icon://excel-attachment" type="Neutral" press="onExcelDownload" visible="false" />
                                <ToolbarSeparator visible="false" />
                                <Text emptyIndicatorMode="On"  text="단위 (억)" visible="false" />
                            </OverflowToolbar>
                        </table:extension>
                         <table:layoutData>
                            <FlexItemData growFactor="1"/>
                        </table:layoutData>
                        

                        <table:columns>
                            <table:Column
                                hAlign="Center"
                                width="10rem"
                                resizable="false"
                                name="type"
                            >
                                <Label
                                    text="조직"
                                    wrapping="true"
                                />
                                <table:template>
                                    <Text emptyIndicatorMode="On"
                                        text="{org_name}"
                                        wrapping="false"
                                        width="100%"
                                        textAlign="Begin"
                                    />
                                </table:template>
                                <table:customData>
                                    <core:CustomData key="mergeKey" value="org_name" />
                                </table:customData>
                            </table:Column>

                            <table:Column
                                hAlign="Center"
                                width="7rem"
                                resizable="false"
                                name="type"
                            >
                                <Label
                                    text="대내/대외"
                                    wrapping="true"
                                />
                                <table:template>
                                    <Text emptyIndicatorMode="On"
                                        text="{type1}"
                                        wrapping="false"
                                        width="100%"
                                        textAlign="Center"
                                        class="custom-text-regular"
                                    />
                                </table:template>
                                <table:customData>
                                    <core:CustomData key="mergeKey" value="type1" />
                                </table:customData>
                            </table:Column>

                            <table:Column
                                hAlign="Center"
                                headerSpan="5"
                                resizable="false"
                                width="7rem"
                            >
                                <table:multiLabels>
                                    <Label
                                        text="연간 추정"
                                        wrapping="true"
                                    />
                                    <Label
                                        text="합계"
                                        textAlign="Center"
                                        width="100%"
                                    />
                                </table:multiLabels>
                                <table:template>
                                    <Text emptyIndicatorMode="On"
                                        text="{
                                            parts:[
                                                {path:'forecast_value', targetType: 'any'}
                                            ],
                                            formatter: '.onFormatPerformance'
                                        }"
                                        tooltip="{
                                            parts:[
                                                {path:'forecast_value', targetType: 'any'},
                                                {value:'tooltip'}
                                            ],
                                            formatter: '.onFormatPerformance'                                
                                        }"
                                        wrapping="false"
                                        width="100%"
                                        textAlign="End"
                                    />
                                </table:template>
                            </table:Column>
                            <table:Column
                                hAlign="Center"
                                width="7rem"
                                resizable="false"
                            >
                                <table:multiLabels>
                                    <Label
                                        text="연간 추정"
                                        wrapping="true"
                                    />
                                    <Label
                                        text="확보"
                                        textAlign="Center"
                                        width="100%"
                                    />
                                </table:multiLabels>
                                <table:template>
                                <Text emptyIndicatorMode="On"
                                    text="{
                                        parts:[
                                            {path:'secured_value', targetType: 'any'},
                                            {path:'type', targetType: 'any'}
                                        ],
                                        formatter: '.onFormatPerformance'
                                    }"
                                    tooltip="{
                                        parts:[
                                            {path:'secured_value', targetType: 'any'},
                                            {path:'type', targetType: 'any'},
                                            {value:'tooltip'}
                                        ],
                                        formatter: '.onFormatPerformance'                                
                                    }"
                                    wrapping="false"
                                    width="100%"
                                    textAlign="End"
                                />
                                </table:template>
                            </table:Column>

                            <table:Column
                                hAlign="Center"
                                width="7rem"
                                resizable="false"
                            >
                                <table:multiLabels>
                                    <Label
                                        text="연간 추정"
                                        wrapping="true"
                                    />
                                    <Label
                                        text="미확보"
                                        textAlign="Center"
                                        width="100%"
                                    />
                                </table:multiLabels>
                                <table:template>
                                    <Text emptyIndicatorMode="On"
                                        text="{
                                            parts:[
                                                {path:'not_secured_value', targetType: 'any'}
                                            ],
                                            formatter: '.onFormatPerformance'
                                        }"
                                        tooltip="{
                                            parts:[
                                                {path:'not_secured_value', targetType: 'any'},
                                                {value:'tooltip'}
                                            ],
                                            formatter: '.onFormatPerformance'                                
                                        }"
                                        wrapping="false"
                                        width="100%"
                                        textAlign="End"
                                    />
                                </table:template>
                            </table:Column>

                            <table:Column
                                hAlign="Center"
                                width="7rem"
                                resizable="false"
                            >
                                <table:multiLabels>
                                    <Label
                                        text="연간 추정"
                                        wrapping="true"
                                    />
                                    <Label
                                        text="계획비"
                                        textAlign="Center"
                                        width="100%"
                                    />
                                </table:multiLabels>
                                <table:template>
                                    <HBox width="100%" height="100%" class="cutsom-table-empty-cell">
                                        <Text text="" width="100%"  />
                                    </HBox>
                                </table:template>
                            </table:Column>

                            <table:Column
                                hAlign="Begin"
                                resizable="false"
                                width="7rem"
                            >
                                <table:multiLabels>
                                    <Label
                                        text="연간 추정"
                                        wrapping="true"
                                    />
                                    <Label
                                        text="전년비"
                                        textAlign="Center"
                                        width="100%"
                                    />
                                </table:multiLabels>
                                <table:template>
                                    <Text emptyIndicatorMode="On"
                                        text="{
                                            parts:[
                                                {path:'yoy', targetType: 'any'}
                                            ],
                                            formatter: '.onFormatPerformance'
                                        }"
                                        tooltip="{
                                            parts:[
                                                {path:'yoy', targetType: 'any'},
                                                {value:'tooltip'}
                                            ],
                                            formatter: '.onFormatPerformance'                                
                                        }"
                                        wrapping="false"
                                        width="100%"
                                        textAlign="End"
                                    />
                                </table:template>
                            </table:Column>
                        </table:columns>
                    </table:Table>
                    </VBox>
                    <VBox fitContainer="true" busyIndicatorDelay="0" visible="{=${uiModel>/subKey} === 'crov'}" class="custom-vbox-wrap-table"
                            height="100%">

                    <table:Table
                        id="planSaleMarginTable6"
                        rows="{path:'/'}"
                        class=" custom-table-container custom-table-header custom-table-body custom-pl-detail-table custom-uiTable-selection custom-inherit-height"
                        selectionMode="Single" 
                        selectionBehavior="RowOnly" 
                        firstVisibleRowChanged="onFirstVisibleRowChanged"
                        rowSelectionChange=".onRowSelectionChange"
                        fixedColumnCount="2"
                        busyIndicatorDelay="0"
                        visibleRowCountMode="Auto"
                        noData=" "
                        fieldGroupIds="content,crov"
                    >
                        <table:extension>
                            <OverflowToolbar width="100%" height="3rem" style="Standard" class="custom-aireport-header">

                                <Image src="./resource/icon/aipopup/aipopup_icon01.png" width="24px" height="24px"/>
                                <Text text="세부 데이터" class="table-title"/>
                                <ToolbarSpacer />
                                <Button text="엑셀 다운로드" class="custom-text-semibold" icon="sap-icon://excel-attachment" type="Neutral" press="onExcelDownload" visible="false" />
                                <ToolbarSeparator visible="false" />
                                <Text emptyIndicatorMode="On"  text="단위 (억)" visible="false" />
                            </OverflowToolbar>
                        </table:extension>

                        <table:layoutData>
                            <FlexItemData growFactor="1"/>
                        </table:layoutData>
                    
                        <table:columns>
                            <table:Column
                                hAlign="Center"
                                width="10rem"
                                resizable="false"
                                name="type"
                            >
                                <Label
                                    text="조직"
                                    wrapping="true"
                                />
                                <table:template>
                                    <Text emptyIndicatorMode="On"
                                        text="{org_name}"
                                        wrapping="false"
                                        width="100%"
                                        textAlign="Begin"
                                    />
                                </table:template>
                                <table:customData>
                                    <core:CustomData key="mergeKey" value="org_name" />
                                </table:customData>
                            </table:Column>

                            <table:Column
                                hAlign="Center"
                                width="7rem"
                                resizable="false"
                                name="type"
                            >
                                <Label
                                    text="신규/이월"
                                    wrapping="true"
                                />
                                <table:template>
                                    <Text emptyIndicatorMode="On"
                                        text="{type1}"
                                        wrapping="false"
                                        width="100%"
                                        textAlign="Begin"
                                    />
                                </table:template>
                                <table:customData>
                                    <core:CustomData key="mergeKey" value="type1" />
                                </table:customData>
                            </table:Column>

                            <table:Column
                                hAlign="Center"
                                headerSpan="5"
                                resizable="false"
                                width="7rem"
                            >
                                <table:multiLabels>
                                    <Label
                                        text="연간 추정"
                                        wrapping="true"
                                    />
                                    <Label
                                        text="합계"
                                        textAlign="Center"
                                        width="100%"
                                    />
                                </table:multiLabels>
                                <table:template>
                                    <Text emptyIndicatorMode="On"
                                        text="{
                                            parts:[
                                                {path:'forecast_value', targetType: 'any'}
                                            ],
                                            formatter: '.onFormatPerformance'
                                        }"
                                        tooltip="{
                                            parts:[
                                                {path:'forecast_value', targetType: 'any'},
                                                {value:'tooltip'}
                                            ],
                                            formatter: '.onFormatPerformance'                                
                                        }"
                                        wrapping="false"
                                        width="100%"
                                        textAlign="End"
                                    />
                                </table:template>
                            </table:Column>
                            <table:Column
                                hAlign="Center"
                                width="7rem"
                                resizable="false"
                            >
                                <table:multiLabels>
                                    <Label
                                        text="연간 추정"
                                        wrapping="true"
                                    />
                                    <Label
                                        text="확보"
                                        textAlign="Center"
                                        width="100%"
                                    />
                                </table:multiLabels>
                                <table:template>
                                    <Text emptyIndicatorMode="On"
                                        text="{
                                            parts:[
                                                {path:'secured_value', targetType: 'any'}
                                            ],
                                            formatter: '.onFormatPerformance'
                                        }"
                                        tooltip="{
                                            parts:[
                                                {path:'secured_value', targetType: 'any'},
                                                {value:'tooltip'}
                                            ],
                                            formatter: '.onFormatPerformance'                                
                                        }"
                                        wrapping="false"
                                        width="100%"
                                        textAlign="End"
                                    />
                                </table:template>
                            </table:Column>

                            <table:Column
                                hAlign="Center"
                                width="7rem"
                                resizable="false"
                            >
                                <table:multiLabels>
                                    <Label
                                        text="연간 추정"
                                        wrapping="true"
                                    />
                                    <Label
                                        text="미확보"
                                        textAlign="Center"
                                        width="100%"
                                    />
                                </table:multiLabels>
                                <table:template>
                                    <Text emptyIndicatorMode="On"
                                        text="{
                                            parts:[
                                                {path:'not_secured_value', targetType: 'any'}
                                            ],
                                            formatter: '.onFormatPerformance'
                                        }"
                                        tooltip="{
                                            parts:[
                                                {path:'not_secured_value', targetType: 'any'},
                                                {value:'tooltip'}
                                            ],
                                            formatter: '.onFormatPerformance'                                
                                        }"
                                        wrapping="false"
                                        width="100%"
                                        textAlign="End"
                                    />
                                </table:template>
                            </table:Column>
                            

                            <table:Column
                                hAlign="Center"
                                width="7rem"
                                resizable="false"
                            >
                                <table:multiLabels>
                                    <Label
                                        text="연간 추정"
                                        wrapping="true"
                                    />
                                    <Label
                                        text="계획비"
                                        textAlign="Center"
                                        width="100%"
                                    />
                                </table:multiLabels>
                                <table:template>
                                    <HBox width="100%" height="100%" class="cutsom-table-empty-cell">
                                        <Text text="" width="100%"  />
                                    </HBox>
                                </table:template>
                            </table:Column>

                            <table:Column
                                hAlign="Begin"
                                resizable="false"
                                width="7rem"
                            >
                                <table:multiLabels>
                                    <Label
                                        text="연간 추정"
                                        wrapping="true"
                                    />
                                    <Label
                                        text="전년비"
                                        textAlign="Center"
                                        width="100%"
                                    />
                                </table:multiLabels>
                                <table:template>
                                    <Text emptyIndicatorMode="On"
                                        text="{
                                            parts:[
                                                {path:'yoy', targetType: 'any'}
                                            ],
                                            formatter: '.onFormatPerformance'
                                        }"
                                        tooltip="{
                                            parts:[
                                                {path:'yoy', targetType: 'any'},
                                                {value:'tooltip'}
                                            ],
                                            formatter: '.onFormatPerformance'                                
                                        }"
                                        wrapping="false"
                                        width="100%"
                                        textAlign="End"
                                    />
                                </table:template>
                            </table:Column>
                        </table:columns>
                    </table:Table>
                </VBox>
            </VBox>
        </content>
    </Panel>
</mvc:View>
