<mvc:View controllerName="bix.pl.performance.controller.Spreadsheet"
    xmlns:layout="sap.ui.layout" 
    xmlns:mvc="sap.ui.core.mvc"
    xmlns="sap.m"
    xmlns:form="sap.ui.layout.form"
    xmlns:table="sap.ui.table"
    xmlns:core="sap.ui.core"
    busyIndicatorDelay="0"
    displayBlock="true"
    width="100%"
    height="100%"
>
    <VBox width="100%" height="100%" >
        <!-- <form:SimpleForm width="100%" editable="true">
            <VBox width="100%">
                <Label text="추정년도" />
                <DatePicker 
                    id="rodr_esmt_y"
                    value="{
                        path: 'exeSearchModel>/rodr_esmt_y',
                        type: 'sap.ui.model.type.Date',
                        formatOptions: {
                            'pattern': 'yyyy'
                        }
                    }" fieldGroupIds="Search,Exe" />
                <layoutData><layout:GridData span="XL2 L3 M4 S6" /></layoutData>
            </VBox>

            <VBox width="100%">
                <Label text="매출조직명" required="true" />
                <MultiInput width="100%" showValueHelp="true" valueHelpRequest=".onOrgSingleSelectDialogOpen" 
                    liveChange="onAddDepInputLiveChange" showSuggestion="false" maxTokens="1" 
                    selectedKey="{exeSearchModel>/sale_org_rid}" tokenUpdate="onAddDepTokenUpdate"
                    fieldGroupIds="Search,Exe,Required" showValueStateMessage="false"/>
                <layoutData><layout:GridData span="XL2 L3 M4 S6" /></layoutData>
            </VBox>

            <HBox width="100%" height="54px" alignItems="End" justifyContent="End" >
                <Button id="exeSearchBtn" text="검색" type="Emphasized" press="onExeSearch($event,'Search')" />
                <Button text="초기화" press="onExeSearch($event,'Refresh')" class="sapUiTinyMarginBegin" />
                <layoutData><layout:GridData span="XL8 L6 M4 S12" /></layoutData>
            </HBox>
        </form:SimpleForm> -->

        <table:Table
            id="exeTable"
            selectionMode="None"
            threshold="10"
            enableBusyIndicator="true"
            fixedColumnCount="4"
            busyIndicatorDelay="0"
            noData="검색 조건 입력 후 검색해주세요."
            >
            <table:extension>
                <OverflowToolbar style="Standard">
                    <Title id="exeTableTitle" text="총 0 건" />
                    <ToolbarSpacer />
                    <Button icon="sap-icon://excel-attachment" text="엑셀 다운로드" type="Transparent"
                        press="onExeExcelDownload" class="sapUiTinyMarginBegin" />
                </OverflowToolbar>
            </table:extension>
        </table:Table>
    </VBox>
</mvc:View>