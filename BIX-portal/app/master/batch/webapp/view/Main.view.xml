<mvc:View 
    id="Main"
    xmlns:simple="sap.gantt.simple" controllerName="bix.master.batch.controller.Main"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns="sap.m"
    xmlns:table="sap.ui.table"
    xmlns:rowmodes="sap.ui.table.rowmodes"
    xmlns:f="sap.f"
    xmlns:core="sap.ui.core"
    xmlns:form="sap.ui.layout.form"
    xmlns:layout="sap.ui.layout"
    xmlns:mdc="sap.ui.mdc" busyIndicatorDelay="0" width="100%">
    <Page class="sapUiContentPadding" showFooter="true" showHeader="false">
        <content>
            <form:SimpleForm  editable="true" class="custom-search-container">
                <form:content>
                    <OverflowToolbar class="custom-toolbar">
                        <ToggleButton press="onTogglePress" class="custom-depth-btn" text="PL"  pressed="true"/>
                        <ToggleButton press="onTogglePress" class="custom-depth-btn" text="DealStage" />
                        <layoutData>
                            <layout:GridData span="XL12 L12 M12 S12" />
                        </layoutData>
                    </OverflowToolbar>
                    <HBox class="custom-search-field-box" alignItems="Center">
                        <Label text="기간" labelFor="dateRange" textAlign="Center" wrapping="false" tooltip="기간">
                            <layoutData>
                                <layout:GridData span="XL2 L2 M2 S12" />
                            </layoutData>
                        </Label>
                        <DatePicker id="datePickerYear" fieldGroupIds="Search,Required" class="sapUiSmallarginEnd"
                            value="{
                                path: 'searchModel>/yearMonth',
                                type: 'sap.ui.model.type.Date',
                                formatOptions: {
                                    format: 'yyyy',
                                    pattern: 'yyyy'
                                }
                            }" 
                            visible="true"
                            change="onDateChange"/>
                        <DatePicker id="datePickerMonth" fieldGroupIds="Search,Required" class="sapUiSmallarginEnd"
                            value="{
                                path: 'searchModel>/yearMonth',
                                type: 'sap.ui.model.type.Date',
                                formatOptions: {
                                    format: 'yyyy-MM',
                                    pattern: 'yyyy-MM'
                                }
                            }" 
                            visible="false"
                            change="onDateChange"/>
                        <layoutData>
                            <layout:GridData span="XL4 L4 M10 S12" />
                        </layoutData>
                    </HBox>
                    <HBox class="custom-search-field-box" alignItems="Center">
                        <Label text="버전" labelFor="version" textAlign="Center" wrapping="false" tooltip="버전" />
                        <Select id ="version" selectedKey="{searchModel>/ver}" width="100%" forceSelection="true"
                            class="custom-mg-select">
                            <core:Item key="{ver}" text="{ver}" />
                        </Select>
                        <layoutData>
                            <layout:GridData span="XL4 L4 M10 S12" />
                        </layoutData>
                    </HBox>
                    <HBox width="100%" justifyContent="End" class="custom-search-btn-container">
                        <Button id="SearchButton" text="조회" type="Accept" press="onVerSearch" class="custom-mg-small-btn"  icon="sap-icon://search"/>
                        <Button text="version 생성" type="Accept" press="onVerSearch" class="custom-mg-small-btn"  />
                        <Button id="batchRunButton" text=" 실행" type="Accept" press="" class="custom-mg-small-btn"  icon="sap-icon://media-play"/>
                        <layoutData>
                            <layout:GridData span="XL12 L12 M12 S12" />
                        </layoutData>
                    </HBox>
                </form:content>
            </form:SimpleForm>
            <Panel width="100%" height="calc(100% - 15rem)" class="sapUiSmallMarginTop">
                <table:Table id="batchTable"
                    class="custom-mg-uiTable custom-selection-uiTable custom-table-rounding-border custom-mg-uiTable-noline" 
                    selectionMode="Single" 
                    selectionBehavior="Row" 
                    busyIndicatorDelay="0"
                    rowActionCount="1"
                    rowSelectionChange="onDetail">
                    <table:extension>
                        <OverflowToolbar width="100%" height="3rem" style="Clear">                                
                            <ToolbarSpacer />
                            <Select  selectedKey="{searchModel>/use}" 
                                change="onSelectionChange"
                                items="{codeModel>/}" 
                                class="custom-mg-select">
                                <core:Item key="{codeModel>value}" text="{codeModel>name}" />
                                <layoutData>
                                    <layout:GridData span="XL2 L2 M2 S12" />
                                </layoutData>
                            </Select>
                        </OverflowToolbar>
                        <ToolbarSpacer />
                    </table:extension>
                    <table:rowMode>
                        <rowmodes:Auto />
                    </table:rowMode>

                    <table:columns>
                        <table:Column width="16rem" hAlign="Center" autoResizable="true">
                            <Label text="버전"   wrapping="true"/>
                            <table:template>
                                <Text text="{ver}" wrapping="false" tooltip="{ver}" />
                            </table:template>
                        </table:Column>

                        <table:Column width="16rem" hAlign="Center" autoResizable="true">
                            <Label text="인터페이스"   wrapping="true"/>
                            <table:template>
                                <Text text="{if_step}" wrapping="false" tooltip="{if_step}" />
                            </table:template>
                        </table:Column>

                        <table:Column width="16rem" hAlign="Center" autoResizable="true">
                            <Label text="대상테이블"   wrapping="true"/>
                            <table:template>
                                <Text text="{table_name}" wrapping="false" tooltip="{table_name}" />
                            </table:template>
                        </table:Column>

                        <table:Column width="16rem" hAlign="Center" autoResizable="true">
                            <Label text="프로시저명"   wrapping="true"/>
                            <table:template>
                                <Text text="{procedure_name}" wrapping="false" tooltip="{procedure_name}" />
                            </table:template>
                        </table:Column>

                        <table:Column width="auto" hAlign="Center" autoResizable="true" >
                            <Label text="내용"   wrapping="true"/>
                            <table:template>
                                <VBox width="100%" height="100%" >
                                    <Text text="{log}"  wrapping="false" />
                                </VBox>
                            </table:template>
                        </table:Column>

                        <table:Column width="8rem" hAlign="Center" autoResizable="true" >
                            <Label text="I/F 수신"   wrapping="true"/>
                            <table:template>
                                <VBox width="100%" height="100%" >
                                    <Text  wrapping="false" />
                                </VBox>
                            </table:template>
                        </table:Column>

                        <table:Column width="8rem" hAlign="Center" autoResizable="true" >
                            <Label text="conversion"  wrapping="true"/>
                            <table:template>
                                <VBox width="100%" height="100%" >
                                    <ObjectStatus
                                        text="{=${success_yn}? '성공' : '실패'}"
                                        state="{=${success_yn}? 'Success' : 'Error'}" />
                                </VBox>
                            </table:template>
                        </table:Column>

                        <table:Column width="8rem" hAlign="Center" autoResizable="true" >
                            <Label text="건수"    wrapping="true"/>
                            <table:template>
                                <VBox width="100%" height="100%" >
                                    <Text text="{row_count}"  wrapping="false" tooltip="{row_count}"/>
                                </VBox>
                            </table:template>
                        </table:Column>

                        <table:Column width="8rem" hAlign="Center" autoResizable="true" >
                            <Label text="소요시간"   wrapping="true"/>
                            <table:template>
                                <VBox width="100%" height="100%" >
                                    <Text text="{execute_time}"  wrapping="false" tooltip="{execute_time}" />
                                </VBox>
                            </table:template>
                        </table:Column>
                        
                        <table:Column width="8rem" hAlign="Center" autoResizable="true" >
                            <Label text="실행"   wrapping="true"/>
                            <table:template>
                                <VBox width="100%" height="100%" >
                                    <Text text="실행" visible="{=${success_yn}===false}"  wrapping="false" />
                                </VBox>
                            </table:template>
                        </table:Column>

                    </table:columns>
                </table:Table>
            </Panel>
        </content>
    </Page>
</mvc:View>